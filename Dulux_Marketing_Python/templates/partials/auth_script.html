<!-- Firebase SDKs & Auth Logic: Tích hợp SDK Firebase và xử lý logic xác thực -->
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js";

    // Cấu hình Firebase
    const firebaseConfig = {
        apiKey: "AIzaSyB3M56NmjF0v6L8w2j8iqgnsc8CK9P253A",
        authDomain: "dulux-marketing.firebaseapp.com",
        projectId: "dulux-marketing",
        storageBucket: "dulux-marketing.firebasestorage.app",
        messagingSenderId: "1034530661104",
        appId: "1:1034530661104:web:265368ed2606874ba89835",
        measurementId: "G-K3B9M6XQXE"
    };

    // Khởi tạo Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // Lắng nghe sự thay đổi trạng thái đăng nhập
    onAuthStateChanged(auth, (user) => {
        const navBtnLogin = document.getElementById('nav-btn-login');
        const navUserProfile = document.getElementById('nav-user-profile');
        const navAvatar = document.getElementById('nav-avatar');
        const navUsername = document.getElementById('nav-username');
        const navBtnLogout = document.getElementById('nav-btn-logout');

        if (user) {
            // User is signed in: Người dùng đã đăng nhập
            if (navBtnLogin) navBtnLogin.classList.add('d-none'); // Ẩn nút đăng nhập
            if (navUserProfile) navUserProfile.classList.remove('d-none'); // Hiện thông tin người dùng

            // Hiển thị avatar (chữ cái đầu của tên hoặc email)
            if (navAvatar) navAvatar.textContent = (user.displayName || user.email)[0].toUpperCase();
            // Hiển thị tên người dùng
            if (navUsername) navUsername.textContent = user.displayName || user.email.split('@')[0];

            // Xử lý sự kiện đăng xuất
            if (navBtnLogout) {
                navBtnLogout.onclick = (e) => {
                    e.preventDefault();
                    signOut(auth).then(() => {
                        window.location.reload(); // Tải lại trang sau khi đăng xuất
                    });
                };
            }
        } else {
            // User is signed out: Người dùng chưa đăng nhập
            if (navBtnLogin) navBtnLogin.classList.remove('d-none'); // Hiện nút đăng nhập
            if (navUserProfile) navUserProfile.classList.add('d-none'); // Ẩn thông tin người dùng
        }
    });
</script>